<script type="text/javascript">
    var detectWPZDict = detectWPZDict || [];
    var fxAppendDetectWPZScript = fxAppendDetectWPZScript || function(){
        if ( typeof(convertDetectedWebPartsToTabs) === "undefined" ){
            var appendScriptTag = document.createElement("SCRIPT");
            appendScriptTag.src = _spPageContextInfo.webAbsoluteUrl +"/SiteAssets/detectWPZ-tabs.js";
            document.head.appendChild(appendScriptTag);
        }
        var appendScriptTag = document.createElement("SCRIPT");
        appendScriptTag.src = _spPageContextInfo.webAbsoluteUrl +"/SiteAssets/detectWPZ-vanilla.js";
        var thisMoment = new Date();
        appendScriptTag.setAttribute("instanceMoment", thisMoment.valueOf());
        document.writeln(appendScriptTag.outerHTML);
        
        var myInt = setInterval(function(){
            if ( typeof(detectWPZ) !== "undefined" ){
                var dictIndex = detectWPZDict.push(new wpzDetector(thisMoment.valueOf()));
                dictIndex--;
                detectWPZDict[dictIndex].scriptTag = document.querySelector("SCRIPT[src*='detectWPZ'][instanceMoment='"+detectWPZDict[dictIndex].instanceName+"']");
                detectWPZDict[dictIndex].guid = detectWPZDict[dictIndex].scriptTag.parentElement.parentElement.getAttribute("webpartid");
                detectWPZDict[dictIndex].myWebPart = detectWPZDict[dictIndex].scriptTag.parentElement.parentElement.parentElement.parentElement;
                detectWPZDict[dictIndex].wpz = detectWPZDict[dictIndex].scriptTag.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement;
                if ( detectWPZ.isPageInEditMode() === false ) {
                    detectWPZ.getZoneWebParts(detectWPZDict[dictIndex], function(siblingWebPart){
                        try{console.log("wpzDetector instance "+ thisMoment.valueOf());}catch(err){}
                        try{console.log(siblingWebPart);}catch(err){}
                    }, function(){
                        try{console.log("wpzDetector instance "+ thisMoment.valueOf() +" finished looping through my WPZ's web parts");}catch(err){}
                        if ( typeof(convertDetectedWebPartsToTabs) !== "undefined" ){
                            convertDetectedWebPartsToTabs();
                        }
                    });
                }
                clearInterval(myInt);
            }
        },756);
        
    };
    fxAppendDetectWPZScript();
</script>